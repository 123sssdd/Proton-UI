# 像素特效

Proton UI 提供了丰富的像素风格视觉特效系统，包括霓虹光晕、玻璃拟态、粒子效果、像素化图片等。所有特效都遵循"像素但不糙"的设计理念，在保持像素美学的同时确保高可读性。

<Callout type="warning" title="关于动画偏好设置">
粒子效果默认会尊重用户的 `prefers-reduced-motion` 系统设置。如果用户在系统中启用了"减少动效"选项，粒子效果将不会触发。

**在开发和演示环境中**，你可以通过设置 `respectMotionPreference={false}` 来禁用这个检查：

```tsx
<ParticleEffect
  type="explosion"
  onClickEmit
  respectMotionPreference={false} // 禁用动画偏好检查
/>
```

**在生产环境中**，建议保持默认值 `respectMotionPreference={true}`（或不设置该属性），以尊重用户的无障碍偏好设置。这是一个重要的可访问性特性。

</Callout>

## 像素化图片

将任意图片转换为像素风格，支持可调像素大小和色彩量化。

<DemoBox
  title="基础像素化"
  description="调整像素大小和色彩级别，实时预览效果"
  code={`import { PixelatedImage } from '@proton-ui/core';

function Avatar() {
return (

<PixelatedImage
      src="/avatar.jpg"
      alt="Avatar"
      pixelSize={8}
      className="rounded-lg"
    />
);
}`}

>

  <div className="flex justify-center">
    <PixelatedImage
      src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=200&h=200&fit=crop"
      alt="示例头像"
      pixelSize={8}
      className="rounded-lg w-48 h-48 object-cover"
    />
  </div>
</DemoBox>

### 预设配置

<DocTabs>
  <DocTabPanel id="retro8bit" label="8-bit 风格">
    <DemoBox
      code={`import { PixelatedImage, PIXELATE_PRESETS } from '@proton-ui/core';

<PixelatedImage
  src="/photo.jpg"
  alt="8-bit Photo"
  pixelSize={8}
  preserveColor={false}
  colorLevels={16}
/>`}
    >
      <div className="flex justify-center">
        <PixelatedImage
          src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=300&h=200&fit=crop"
          alt="8-bit 风格"
          pixelSize={8}
          preserveColor={false}
          colorLevels={16}
          className="rounded-lg"
        />
      </div>
    </DemoBox>
  </DocTabPanel>

<DocTabPanel id="retro16bit" label="16-bit 风格">
  <DemoBox
    code={`<PixelatedImage
  src="/photo.jpg"
  alt="16-bit Photo"
  pixelSize={4}
  preserveColor={false}
  colorLevels={256}
/>`}
  >
    <div className="flex justify-center">
      <PixelatedImage
        src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=300&h=200&fit=crop"
        alt="16-bit 风格"
        pixelSize={4}
        preserveColor={false}
        colorLevels={256}
        className="rounded-lg"
      />
    </div>
  </DemoBox>
</DocTabPanel>

  <DocTabPanel id="modern" label="现代像素风">
    <DemoBox
      code={`<PixelatedImage
  src="/photo.jpg"
  alt="Modern Pixel"
  pixelSize={8}
  preserveColor={true}
  className="rounded-lg"
/>`}
    >
      <div className="flex justify-center">
        <PixelatedImage
          src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=300&h=200&fit=crop"
          alt="现代像素风"
          pixelSize={8}
          preserveColor={true}
          className="rounded-lg"
        />
      </div>
    </DemoBox>
  </DocTabPanel>
</DocTabs>

## 粒子效果

高性能的像素风格粒子动画系统，支持多种效果类型。

### 爆炸效果

<DemoBox
  title="点击爆炸"
  description="点击区域触发粒子爆炸效果"
  code={`import { ParticleEffect } from '@proton-ui/core';

<ParticleEffect
  type="explosion"
  onClickEmit
  count={30}
  colors={['#4ECDC4', '#FF6B9D', '#FFB86C']}
  size={{ min: 2, max: 4 }}
  speed={{ min: 100, max: 200 }}
  life={{ min: 500, max: 1500 }}
  respectMotionPreference={false}  // 仅用于演示，生产环境建议移除
/>`}
>
  <div className="relative h-64 bg-gray-900 rounded-lg overflow-hidden">
    <ParticleEffect
      type="explosion"
      onClickEmit
      count={30}
      colors={['#4ECDC4', '#FF6B9D', '#FFB86C', '#7FD99F']}
      size={{ min: 2, max: 4 }}
      speed={{ min: 100, max: 200 }}
      life={{ min: 500, max: 1500 }}
      respectMotionPreference={false}
    />
    <div className="absolute inset-0 flex items-center justify-center text-white text-lg">
      点击任意位置触发爆炸效果
    </div>
  </div>
</DemoBox>

### 漂浮效果

<DemoBox
  title="漂浮粒子"
  description="粒子从底部向上漂浮，模拟气泡或萤火虫效果"
  code={`<ParticleEffect
  type="float"
  autoTrigger
  triggerInterval={1000}
  count={5}
  colors={['#4ECDC4', '#7FD99F', '#FFB86C']}
  size={{ min: 2, max: 3 }}
  speed={{ min: 30, max: 60 }}
  life={{ min: 3000, max: 5000 }}
/>`}
>
  <div className="relative h-64 bg-gradient-to-b from-gray-900 to-gray-800 rounded-lg overflow-hidden">
    <ParticleEffect
      type="float"
      autoTrigger
      triggerInterval={1000}
      count={5}
      colors={["#4ECDC4", "#7FD99F", "#FFB86C"]}
      size={{ min: 2, max: 3 }}
      speed={{ min: 30, max: 60 }}
      life={{ min: 3000, max: 5000 }}
      respectMotionPreference={false}
    />
    <div className="absolute inset-0 flex items-center justify-center text-white text-lg">
      漂浮的粒子
    </div>
  </div>
</DemoBox>

### 闪烁效果

<DemoBox
  title="星星闪烁"
  description="粒子在原地闪烁，创造星空效果"
  code={`<ParticleEffect
  type="sparkle"
  autoTrigger
  triggerInterval={500}
  count={10}
  colors={['#FFB86C', '#D4AF37', '#FFFFFF']}
  size={{ min: 2, max: 4 }}
  life={{ min: 800, max: 1200 }}
/>`}
>
  <div className="relative h-64 bg-gray-950 rounded-lg overflow-hidden">
    <ParticleEffect
      type="sparkle"
      autoTrigger
      triggerInterval={500}
      count={10}
      colors={["#FFB86C", "#D4AF37", "#FFFFFF"]}
      size={{ min: 2, max: 4 }}
      life={{ min: 800, max: 1200 }}
      respectMotionPreference={false}
    />
    <div className="absolute inset-0 flex items-center justify-center text-white text-lg">
      闪烁的星星
    </div>
  </div>
</DemoBox>

### 雪花飘落

<DemoBox
  title="雪花效果"
  description="雪花从顶部飘落，带有轻微摆动"
  code={`<ParticleEffect
  type="snow"
  autoTrigger
  triggerInterval={800}
  count={8}
  colors={['#FFFFFF', '#E8E4DB', '#A8A4A0']}
  size={{ min: 2, max: 3 }}
  speed={{ min: 40, max: 80 }}
  life={{ min: 4000, max: 6000 }}
/>`}
>
  <div className="relative h-64 bg-gradient-to-b from-blue-900 to-blue-800 rounded-lg overflow-hidden">
    <ParticleEffect
      type="snow"
      autoTrigger
      triggerInterval={800}
      count={8}
      colors={["#FFFFFF", "#E8E4DB", "#A8A4A0"]}
      size={{ min: 2, max: 3 }}
      speed={{ min: 40, max: 80 }}
      life={{ min: 4000, max: 6000 }}
      respectMotionPreference={false}
    />
    <div className="absolute inset-0 flex items-center justify-center text-white text-lg">
      飘落的雪花
    </div>
  </div>
</DemoBox>

## 霓虹光晕

模拟霓虹灯管的发光效果，提供 5 种颜色预设和 3 种强度级别。

<DemoBox
  title="霓虹文字"
  description="不同颜色的霓虹光晕效果"
  code={`<h2 className="neon-glow-cyan text-4xl font-bold">霓虹青</h2>
<h2 className="neon-glow-pink text-4xl font-bold">樱花粉</h2>
<h2 className="neon-glow-purple text-4xl font-bold">蒸汽紫</h2>
<h2 className="neon-glow-gold text-4xl font-bold">神圣金</h2>
<h2 className="neon-glow-green text-4xl font-bold">抹茶绿</h2>`}
>
  <div className="bg-gray-900 p-8 rounded-lg space-y-4">
    <h2 className="neon-glow-cyan text-4xl font-bold text-center">霓虹青</h2>
    <h2 className="neon-glow-pink text-4xl font-bold text-center">樱花粉</h2>
    <h2 className="neon-glow-purple text-4xl font-bold text-center">蒸汽紫</h2>
    <h2 className="neon-glow-gold text-4xl font-bold text-center">神圣金</h2>
    <h2 className="neon-glow-green text-4xl font-bold text-center">抹茶绿</h2>
  </div>
</DemoBox>

### 霓虹动画

<DocTabs>
  <DocTabPanel id="pulse" label="脉冲动画">
    <DemoBox
      code={`<h2 className="neon-glow-cyan neon-pulse text-4xl font-bold">
  脉冲光晕
</h2>`}
    >
      <div className="bg-gray-900 p-8 rounded-lg">
        <h2 className="neon-glow-cyan neon-pulse text-4xl font-bold text-center">
          脉冲光晕
        </h2>
      </div>
    </DemoBox>
  </DocTabPanel>

<DocTabPanel id="flicker" label="闪烁动画">
  <DemoBox
    code={`<h2 className="neon-glow-pink neon-flicker text-4xl font-bold">
  闪烁光晕
</h2>`}
  >
    <div className="bg-gray-900 p-8 rounded-lg">
      <h2 className="neon-glow-pink neon-flicker text-4xl font-bold text-center">
        闪烁光晕
      </h2>
    </div>
  </DemoBox>
</DocTabPanel>

  <DocTabPanel id="breathe" label="呼吸动画">
    <DemoBox
      code={`<h2 className="neon-glow-purple neon-breathe text-4xl font-bold">
  呼吸光晕
</h2>`}
    >
      <div className="bg-gray-900 p-8 rounded-lg">
        <h2 className="neon-glow-purple neon-breathe text-4xl font-bold text-center">
          呼吸光晕
        </h2>
      </div>
    </DemoBox>
  </DocTabPanel>
</DocTabs>

## 玻璃拟态

创建毛玻璃背景和边缘高光，适合现代、优雅的界面设计。

<DemoBox
  title="玻璃卡片"
  description="不同强度的玻璃拟态效果"
  code={`<div className="glass-morphism-subtle p-6 rounded-lg">
  <h3 className="text-white font-bold mb-2">轻微玻璃效果</h3>
  <p className="text-gray-300">适合背景元素</p>
</div>

<div className="glass-morphism p-6 rounded-lg">
  <h3 className="text-white font-bold mb-2">标准玻璃效果</h3>
  <p className="text-gray-300">适合卡片和面板</p>
</div>

<div className="glass-morphism-strong p-6 rounded-lg">
  <h3 className="text-white font-bold mb-2">强烈玻璃效果</h3>
  <p className="text-gray-300">适合重要内容</p>
</div>`}
>
  <div
    className="p-8 rounded-lg space-y-4"
    style={{
      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
    }}
  >
    <div className="glass-morphism-subtle p-6 rounded-lg">
      <h3 className="text-white font-bold mb-2">轻微玻璃效果</h3>
      <p className="text-gray-300">适合背景元素</p>
    </div>

    <div className="glass-morphism p-6 rounded-lg">
      <h3 className="text-white font-bold mb-2">标准玻璃效果</h3>
      <p className="text-gray-300">适合卡片和面板</p>
    </div>

    <div className="glass-morphism-strong p-6 rounded-lg">
      <h3 className="text-white font-bold mb-2">强烈玻璃效果</h3>
      <p className="text-gray-300">适合重要内容</p>
    </div>

  </div>
</DemoBox>

### 彩色玻璃

<DemoBox
  title="彩色玻璃变体"
  code={`<div className="glass-morphism-cyan p-6 rounded-lg">青色玻璃</div>
<div className="glass-morphism-pink p-6 rounded-lg">粉色玻璃</div>
<div className="glass-morphism-purple p-6 rounded-lg">紫色玻璃</div>`}
>
  <div
    className="p-8 rounded-lg space-y-4"
    style={{
      background: "linear-gradient(135deg, #1e3a8a 0%, #1e293b 100%)",
    }}
  >
    <div className="glass-morphism-cyan p-6 rounded-lg">
      <h3 className="text-white font-bold">青色玻璃</h3>
    </div>
    <div className="glass-morphism-pink p-6 rounded-lg">
      <h3 className="text-white font-bold">粉色玻璃</h3>
    </div>
    <div className="glass-morphism-purple p-6 rounded-lg">
      <h3 className="text-white font-bold">紫色玻璃</h3>
    </div>
  </div>
</DemoBox>

## CRT 屏幕效果

模拟老式 CRT 显示器的视觉特征，包括曲面、扫描线、色散等效果。

<DemoBox
  title="CRT 效果组合"
  description="完整的 CRT 显示器模拟效果"
  code={`<div className="crt-curvature-level-3 scanline-density-medium crt-chromatic-level-1 p-8 rounded-lg bg-gray-900">
  <h3 className="text-cyan-400 text-2xl font-bold mb-4">复古终端</h3>
  <p className="text-green-400 font-mono">System initialized...</p>
  <p className="text-green-400 font-mono">Loading modules...</p>
  <p className="text-green-400 font-mono">Ready.</p>
</div>`}
>
  <div className="crt-curvature-level-3 scanline-density-medium crt-chromatic-level-1 p-8 rounded-lg bg-gray-900">
    <h3 className="text-cyan-400 text-2xl font-bold mb-4">复古终端</h3>
    <p className="text-green-400 font-mono">System initialized...</p>
    <p className="text-green-400 font-mono">Loading modules...</p>
    <p className="text-green-400 font-mono">Ready.</p>
  </div>
</DemoBox>

## Dithering 效果

使用像素矩阵模拟渐变效果，是经典像素艺术的核心技术。

<DemoBox
  title="Dithering 渐变"
  description="4x4 像素矩阵创建的渐变效果"
  code={`<div className="relative h-32 rounded-lg overflow-hidden">
  <div className="dithering-4x4-25 absolute inset-0 text-cyan-400"></div>
  <div className="dithering-4x4-50 absolute inset-0 text-pink-400"></div>
  <div className="dithering-4x4-75 absolute inset-0 text-purple-400"></div>
</div>`}
>
  <div className="relative h-32 rounded-lg overflow-hidden bg-gray-900">
    <div className="dithering-4x4-25 absolute inset-0 text-cyan-400"></div>
    <div className="dithering-4x4-50 absolute inset-0 text-pink-400"></div>
    <div className="dithering-4x4-75 absolute inset-0 text-purple-400"></div>
  </div>
</DemoBox>

## 效果组合

<DemoBox
  title="多重特效叠加"
  description="组合使用多种特效创建独特风格"
  code={`<div className="relative h-64 rounded-lg overflow-hidden">
  {/* 背景漂浮粒子 */}
  <ParticleEffect
    type="float"
    autoTrigger
    triggerInterval={1500}
    count={3}
    colors={['#4ECDC4', '#7FD99F']}
  />

{/* 点击爆炸效果 */}

<ParticleEffect
  type="explosion"
  onClickEmit
  count={40}
  colors={["#FF6B9D", "#FFB86C"]}
/>

{/* 玻璃拟态卡片 */}

  <div className="glass-morphism-cyan neon-glow-cyan-box p-8">
    <h2 className="neon-glow-cyan neon-pulse text-3xl font-bold">
      赛博朋克卡片
    </h2>
    <p className="text-white mt-4">
      组合多种特效创建独特风格
    </p>
  </div>
</div>`}
>
  <div
    className="relative h-64 rounded-lg overflow-hidden"
    style={{
      background: "linear-gradient(135deg, #1e3a8a 0%, #1e293b 100%)",
    }}
  >
    {/* 背景漂浮粒子 */}
    <ParticleEffect
      type="float"
      autoTrigger
      triggerInterval={1500}
      count={3}
      colors={["#4ECDC4", "#7FD99F"]}
      style={{ zIndex: 1 }}
      respectMotionPreference={false}
    />

    {/* 点击爆炸效果 */}
    <ParticleEffect
      type="explosion"
      onClickEmit
      count={40}
      colors={["#FF6B9D", "#FFB86C", "#FFFFFF"]}
      size={{ min: 2, max: 5 }}
      speed={{ min: 80, max: 180 }}
      life={{ min: 600, max: 1200 }}
      style={{ zIndex: 2 }}
      respectMotionPreference={false}
    />

    {/* 玻璃拟态卡片 */}
    <div
      className="absolute inset-0 flex items-center justify-center"
      style={{ zIndex: 10 }}
    >
      <div className="glass-morphism-cyan neon-glow-cyan-box p-8 rounded-lg">
        <h2 className="neon-glow-cyan neon-pulse text-3xl font-bold mb-4">
          赛博朋克卡片
        </h2>
        <p className="text-white">组合多种特效创建独特风格</p>
      </div>
    </div>

  </div>
</DemoBox>

## API 文档

### PixelatedImage Props

<PropsTable
  data={[
    {
      name: "src",
      type: "string | File | HTMLImageElement",
      required: true,
      defaultValue: "-",
      description: "图片源",
    },
    {
      name: "pixelSize",
      type: "number",
      required: false,
      defaultValue: "8",
      description: "像素块大小",
    },
    {
      name: "preserveColor",
      type: "boolean",
      required: false,
      defaultValue: "true",
      description: "是否保持原始色彩",
    },
    {
      name: "colorLevels",
      type: "number",
      required: false,
      defaultValue: "256",
      description: "色彩量化级别（1-256）",
    },
    {
      name: "quality",
      type: "number",
      required: false,
      defaultValue: "0.92",
      description: "输出图片质量（0-1）",
    },
    {
      name: "className",
      type: "string",
      required: false,
      defaultValue: "-",
      description: "自定义类名",
    },
    {
      name: "onLoad",
      type: "(pixelatedSrc: string) => void",
      required: false,
      defaultValue: "-",
      description: "处理完成回调",
    },
    {
      name: "onError",
      type: "(error: Error) => void",
      required: false,
      defaultValue: "-",
      description: "处理失败回调",
    },
  ]}
/>

### ParticleEffect Props

<PropsTable
  data={[
    {
      name: "type",
      type: "'explosion' | 'float' | 'sparkle' | 'snow'",
      required: true,
      defaultValue: "-",
      description: "粒子效果类型",
    },
    {
      name: "autoTrigger",
      type: "boolean",
      required: false,
      defaultValue: "false",
      description: "是否自动触发效果",
    },
    {
      name: "triggerInterval",
      type: "number",
      required: false,
      defaultValue: "2000",
      description: "自动触发间隔（毫秒）",
    },
    {
      name: "count",
      type: "number",
      required: false,
      defaultValue: "20",
      description: "每次发射的粒子数量",
    },
    {
      name: "colors",
      type: "string[]",
      required: false,
      defaultValue: "默认色盘",
      description: "粒子颜色数组",
    },
    {
      name: "size",
      type: "{ min: number; max: number }",
      required: false,
      defaultValue: "{ min: 2, max: 4 }",
      description: "粒子大小范围",
    },
    {
      name: "speed",
      type: "{ min: number; max: number }",
      required: false,
      defaultValue: "根据类型",
      description: "粒子速度范围",
    },
    {
      name: "life",
      type: "{ min: number; max: number }",
      required: false,
      defaultValue: "根据类型",
      description: "粒子生命周期（毫秒）",
    },
    {
      name: "onClickEmit",
      type: "boolean",
      required: false,
      defaultValue: "false",
      description: "点击时触发粒子效果",
    },
    {
      name: "respectMotionPreference",
      type: "boolean",
      required: false,
      defaultValue: "true",
      description:
        "是否尊重用户的 prefers-reduced-motion 设置。设为 false 可在测试/演示时禁用检查",
    },
  ]}
/>

## 性能考虑

<Callout type="warning" title="性能建议">
像素特效使用 Canvas 和 CSS 动画，对性能有一定影响。建议：

- **粒子数量**：同时存在的粒子不宜超过 500 个
- **像素化图片**：限制图片尺寸在 2000x2000 以内
- **霓虹光晕**：避免在整个页面大量使用
- **动画效果**：同时运行的动画不要超过 10 个

</Callout>

<Callout type="info" title="可访问性">
所有动画效果都支持 `prefers-reduced-motion` 设置。当用户在操作系统中启用"减少动效"时：

- **粒子效果**：默认不会触发（可通过 `respectMotionPreference={false}` 覆盖）
- **霓虹动画**：自动禁用脉冲、闪烁、呼吸等动画
- **CRT 效果**：保持静态效果，禁用闪烁和开关机动画
- **Dithering 动画**：停止像素点移动和闪烁

这是一个重要的无障碍特性，可以帮助有前庭障碍或对动画敏感的用户更舒适地使用应用。

</Callout>

## 浏览器兼容性

- **Canvas API**: 所有现代浏览器支持
- **backdrop-filter**: Chrome 76+, Safari 9+, Firefox 103+
- **text-shadow / box-shadow**: 所有现代浏览器支持
- **CSS 动画**: 所有现代浏览器支持

## 最佳实践

### 1. 选择合适的像素大小

```tsx
// 小图标：4px
<PixelatedImage src="/icon.png" pixelSize={4} />

// 头像：8px
<PixelatedImage src="/avatar.jpg" pixelSize={8} />

// 背景图：16px
<PixelatedImage src="/background.jpg" pixelSize={16} />
```

### 2. 限制粒子数量

```tsx
// 背景装饰：少量粒子
<ParticleEffect type="float" count={3} />

// 点击反馈：中等数量
<ParticleEffect type="explosion" count={30} />

// 避免：过多粒子
<ParticleEffect type="explosion" count={200} /> // ❌
```

### 3. 合理使用霓虹光晕

```tsx
// ✅ 用于强调重要元素
<h1 className="neon-glow-cyan">重要标题</h1>

// ❌ 避免在整个页面使用
<div className="neon-glow-cyan">
  <p className="neon-glow-pink">...</p>
  <p className="neon-glow-purple">...</p>
</div>
```

### 4. 组合效果要适度

```tsx
// ✅ 2-3 种效果组合
<div className="glass-morphism neon-glow-cyan-box">
  内容
</div>

// ❌ 避免过度叠加
<div className="glass-morphism neon-glow-cyan-box crt-full-effect dithering-animated">
  内容
</div>
```

## 相关资源

- [像素特效使用指南](/guide/pixel-effects)
- [主题系统](/components/theme/theme-gallery)
- [设计令牌](/guide/design-tokens)
