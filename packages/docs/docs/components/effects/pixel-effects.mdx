# 像素特效

Proton UI 提供了丰富的像素风格视觉特效系统，包括霓虹光晕、玻璃拟态、粒子效果、像素化图片等。所有特效都遵循"像素但不糙"的设计理念，在保持像素美学的同时确保高可读性。

<Callout type="warning" title="关于动画偏好设置">
粒子效果默认会尊重用户的 `prefers-reduced-motion` 系统设置。如果用户在系统中启用了"减少动效"选项，粒子效果将不会触发。

**在开发和演示环境中**，你可以通过设置 `respectMotionPreference={false}` 来禁用这个检查：

```tsx
<ParticleEffect
  type="explosion"
  onClickEmit
  respectMotionPreference={false} // 禁用动画偏好检查
/>
```

**在生产环境中**，建议保持默认值 `respectMotionPreference={true}`（或不设置该属性），以尊重用户的无障碍偏好设置。这是一个重要的可访问性特性。

</Callout>

## 粒子效果演示

完整的粒子效果控制面板，支持 4 种粒子类型、参数调节和性能监控。

<ParticleEffectDemo />

## 像素化图片演示

交互式像素化图片演示，支持示例图片选择、预设风格和参数调节。

<PixelatedImageDemo />

## 像素化图片

将任意图片转换为像素风格，支持可调像素大小和色彩量化。

<DemoBox
  title="基础像素化"
  description="调整像素大小和色彩级别，实时预览效果"
  code={`import { PixelatedImage } from '@proton-ui/core';

function Avatar() {
return (

<PixelatedImage
      src="/avatar.jpg"
      alt="Avatar"
      pixelSize={8}
      className="rounded-lg"
    />
);
}`}

>

  <div className="flex justify-center">
    <PixelatedImage
      src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=200&h=200&fit=crop"
      alt="示例头像"
      pixelSize={8}
      className="rounded-lg w-48 h-48 object-cover"
    />
  </div>
</DemoBox>

### 预设配置

<DocTabs>
  <DocTabPanel id="retro8bit" label="8-bit 风格">
    <DemoBox
      code={`import { PixelatedImage, PIXELATE_PRESETS } from '@proton-ui/core';

<PixelatedImage
  src="/photo.jpg"
  alt="8-bit Photo"
  pixelSize={8}
  preserveColor={false}
  colorLevels={16}
/>`}
    >
      <div className="flex justify-center">
        <PixelatedImage
          src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=300&h=200&fit=crop"
          alt="8-bit 风格"
          pixelSize={8}
          preserveColor={false}
          colorLevels={16}
          className="rounded-lg"
        />
      </div>
    </DemoBox>
  </DocTabPanel>

<DocTabPanel id="retro16bit" label="16-bit 风格">
  <DemoBox
    code={`<PixelatedImage
  src="/photo.jpg"
  alt="16-bit Photo"
  pixelSize={4}
  preserveColor={false}
  colorLevels={256}
/>`}
  >
    <div className="flex justify-center">
      <PixelatedImage
        src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=300&h=200&fit=crop"
        alt="16-bit 风格"
        pixelSize={4}
        preserveColor={false}
        colorLevels={256}
        className="rounded-lg"
      />
    </div>
  </DemoBox>
</DocTabPanel>

  <DocTabPanel id="modern" label="现代像素风">
    <DemoBox
      code={`<PixelatedImage
  src="/photo.jpg"
  alt="Modern Pixel"
  pixelSize={8}
  preserveColor={true}
  className="rounded-lg"
/>`}
    >
      <div className="flex justify-center">
        <PixelatedImage
          src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=300&h=200&fit=crop"
          alt="现代像素风"
          pixelSize={8}
          preserveColor={true}
          className="rounded-lg"
        />
      </div>
    </DemoBox>
  </DocTabPanel>
</DocTabs>

## 霓虹光晕

模拟霓虹灯管的发光效果，提供 5 种颜色预设和 3 种强度级别。

<NeonEffectsDemo />

## 玻璃拟态

创建毛玻璃背景和边缘高光，适合现代、优雅的界面设计。

<GlassEffectsDemo />

## CRT 屏幕效果

模拟老式 CRT 显示器的视觉特征，包括曲面、扫描线、色散等效果。

<DemoBox
  title="CRT 效果组合"
  description="完整的 CRT 显示器模拟效果"
  code={`<div className="crt-curvature-level-3 scanline-density-medium crt-chromatic-level-1 p-8 rounded-lg bg-gray-900">
  <h3 className="text-cyan-400 text-2xl font-bold mb-4">复古终端</h3>
  <p className="text-green-400 font-mono">System initialized...</p>
  <p className="text-green-400 font-mono">Loading modules...</p>
  <p className="text-green-400 font-mono">Ready.</p>
</div>`}
>
  <div className="crt-curvature-level-3 scanline-density-medium crt-chromatic-level-1 p-8 rounded-lg bg-gray-900">
    <h3 className="text-cyan-400 text-2xl font-bold mb-4">复古终端</h3>
    <p className="text-green-400 font-mono">System initialized...</p>
    <p className="text-green-400 font-mono">Loading modules...</p>
    <p className="text-green-400 font-mono">Ready.</p>
  </div>
</DemoBox>

## Dithering 效果

使用像素矩阵模拟渐变效果，是经典像素艺术的核心技术。

<DitheringEffectsDemo />

## 效果组合

<CombinedEffectsDemo />

## API 文档

### PixelatedImage Props

<PropsTable
  data={[
    {
      name: "src",
      type: "string | File | HTMLImageElement",
      required: true,
      defaultValue: "-",
      description: "图片源",
    },
    {
      name: "pixelSize",
      type: "number",
      required: false,
      defaultValue: "8",
      description: "像素块大小",
    },
    {
      name: "preserveColor",
      type: "boolean",
      required: false,
      defaultValue: "true",
      description: "是否保持原始色彩",
    },
    {
      name: "colorLevels",
      type: "number",
      required: false,
      defaultValue: "256",
      description: "色彩量化级别（1-256）",
    },
    {
      name: "quality",
      type: "number",
      required: false,
      defaultValue: "0.92",
      description: "输出图片质量（0-1）",
    },
    {
      name: "className",
      type: "string",
      required: false,
      defaultValue: "-",
      description: "自定义类名",
    },
    {
      name: "onLoad",
      type: "(pixelatedSrc: string) => void",
      required: false,
      defaultValue: "-",
      description: "处理完成回调",
    },
    {
      name: "onError",
      type: "(error: Error) => void",
      required: false,
      defaultValue: "-",
      description: "处理失败回调",
    },
  ]}
/>

### ParticleEffect Props

<PropsTable
  data={[
    {
      name: "type",
      type: "'explosion' | 'float' | 'sparkle' | 'snow'",
      required: true,
      defaultValue: "-",
      description: "粒子效果类型",
    },
    {
      name: "autoTrigger",
      type: "boolean",
      required: false,
      defaultValue: "false",
      description: "是否自动触发效果",
    },
    {
      name: "triggerInterval",
      type: "number",
      required: false,
      defaultValue: "2000",
      description: "自动触发间隔（毫秒）",
    },
    {
      name: "count",
      type: "number",
      required: false,
      defaultValue: "20",
      description: "每次发射的粒子数量",
    },
    {
      name: "colors",
      type: "string[]",
      required: false,
      defaultValue: "默认色盘",
      description: "粒子颜色数组",
    },
    {
      name: "size",
      type: "{ min: number; max: number }",
      required: false,
      defaultValue: "{ min: 2, max: 4 }",
      description: "粒子大小范围",
    },
    {
      name: "speed",
      type: "{ min: number; max: number }",
      required: false,
      defaultValue: "根据类型",
      description: "粒子速度范围",
    },
    {
      name: "life",
      type: "{ min: number; max: number }",
      required: false,
      defaultValue: "根据类型",
      description: "粒子生命周期（毫秒）",
    },
    {
      name: "onClickEmit",
      type: "boolean",
      required: false,
      defaultValue: "false",
      description: "点击时触发粒子效果",
    },
    {
      name: "respectMotionPreference",
      type: "boolean",
      required: false,
      defaultValue: "true",
      description:
        "是否尊重用户的 prefers-reduced-motion 设置。设为 false 可在测试/演示时禁用检查",
    },
  ]}
/>

## 性能考虑

<Callout type="warning" title="性能建议">
像素特效使用 Canvas 和 CSS 动画，对性能有一定影响。建议：

- **粒子数量**：同时存在的粒子不宜超过 500 个
- **像素化图片**：限制图片尺寸在 2000x2000 以内
- **霓虹光晕**：避免在整个页面大量使用
- **动画效果**：同时运行的动画不要超过 10 个

</Callout>

<Callout type="info" title="可访问性">
所有动画效果都支持 `prefers-reduced-motion` 设置。当用户在操作系统中启用"减少动效"时：

- **粒子效果**：默认不会触发（可通过 `respectMotionPreference={false}` 覆盖）
- **霓虹动画**：自动禁用脉冲、闪烁、呼吸等动画
- **CRT 效果**：保持静态效果，禁用闪烁和开关机动画
- **Dithering 动画**：停止像素点移动和闪烁

这是一个重要的无障碍特性，可以帮助有前庭障碍或对动画敏感的用户更舒适地使用应用。

</Callout>

## 浏览器兼容性

- **Canvas API**: 所有现代浏览器支持
- **backdrop-filter**: Chrome 76+, Safari 9+, Firefox 103+
- **text-shadow / box-shadow**: 所有现代浏览器支持
- **CSS 动画**: 所有现代浏览器支持

## 最佳实践

### 1. 选择合适的像素大小

```tsx
// 小图标：4px
<PixelatedImage src="/icon.png" pixelSize={4} />

// 头像：8px
<PixelatedImage src="/avatar.jpg" pixelSize={8} />

// 背景图：16px
<PixelatedImage src="/background.jpg" pixelSize={16} />
```

### 2. 限制粒子数量

```tsx
// 背景装饰：少量粒子
<ParticleEffect type="float" count={3} />

// 点击反馈：中等数量
<ParticleEffect type="explosion" count={30} />

// 避免：过多粒子
<ParticleEffect type="explosion" count={200} /> // ❌
```

### 3. 合理使用霓虹光晕

```tsx
// ✅ 用于强调重要元素
<h1 className="neon-glow-cyan">重要标题</h1>

// ❌ 避免在整个页面使用
<div className="neon-glow-cyan">
  <p className="neon-glow-pink">...</p>
  <p className="neon-glow-purple">...</p>
</div>
```

### 4. 组合效果要适度

```tsx
// ✅ 2-3 种效果组合
<div className="glass-morphism neon-glow-cyan-box">
  内容
</div>

// ❌ 避免过度叠加
<div className="glass-morphism neon-glow-cyan-box crt-full-effect dithering-animated">
  内容
</div>
```

## 相关资源

- [像素特效使用指南](/guide/pixel-effects)
- [主题系统](/components/theme/theme-gallery)
- [设计令牌](/guide/design-tokens)
